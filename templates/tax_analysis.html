{% extends "base.html" %}

{% block title %}MyStockTax - Tax 분석{% endblock %}

{% block content %}
<!-- TAX 분석 메인 화면 -->
<div class="tax-analysis-container">
    <!-- 상단 로고 영역 -->
    <div class="logo-section">
        <div class="logo-container">
            <div class="logo-text">
                <h1>MyStockTax</h1>
            </div>
        </div>
        <div class="active-indicator"></div>
    </div>

    <!-- 메인 검색 영역 -->
    <div class="search-section">
        <div class="search-container">
            <!-- 기간 선택 드롭다운 -->
            <div class="period-dropdown">
                <select class="period-select" id="periodSelect">
                    <option value="5">5년</option>
                    <option value="10">10년</option>
                </select>
            </div>
            
            <!-- 메인 검색 바 -->
            <div class="main-search-bar">
                <input type="text" class="search-input" placeholder="종목명, 종목코드, 키워드를 입력하세요..." id="mainSearchInput">
                <div class="search-controls">
                    <button class="clear-btn" onclick="clearSearch()">
                        <i class="fas fa-times"></i>
                    </button>
                    <button class="search-btn" onclick="performSearch()">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
    // 페이지 로드 시 초기화
    document.addEventListener('DOMContentLoaded', function() {
        setupTransactionDate();
        // 5년이 기본값으로 설정
        document.getElementById('periodSelect').value = '5';
    });

    // 검색 기능
    function performSearch() {
        const searchTerm = document.getElementById('mainSearchInput').value.trim();
        const period = document.getElementById('periodSelect').value;
        
        if (searchTerm) {
            showAlert(`"${searchTerm}" 검색 결과를 준비 중입니다. (${period}년 기준)`, 'info');
            // 실제 검색 로직 구현 예정
        } else {
            showAlert('검색어를 입력해주세요.', 'warning');
        }
    }

    // 검색어 지우기
    function clearSearch() {
        document.getElementById('mainSearchInput').value = '';
        document.getElementById('mainSearchInput').focus();
    }

    // 엔터키로 검색
    document.addEventListener('DOMContentLoaded', function() {
        const searchInput = document.getElementById('mainSearchInput');
        if (searchInput) {
            searchInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    performSearch();
                }
            });
        }
    });

    // 기간 변경 이벤트
    document.addEventListener('DOMContentLoaded', function() {
        const periodSelect = document.getElementById('periodSelect');
        if (periodSelect) {
            periodSelect.addEventListener('change', function() {
                const period = this.value;
                showAlert(`${period}년 기준으로 검색이 설정되었습니다.`, 'info');
            });
        }
    });

    // 거래 날짜 기본값 설정
    function setupTransactionDate() {
        const dateInput = document.getElementById('transactionDate');
        if (dateInput) {
            dateInput.value = new Date().toISOString().split('T')[0];
        }
    }
</script>
{% endblock %}
